---
const portalUrl = import.meta.env.PUBLIC_PORTAL_URL || 'https://app.issyx.com';

const solutions = [
  {
    name: 'Imaging & Deployment',
    description: 'PXE boot imaging, custom profiles, and asset engraving',
    href: '/solutions/imaging-deployment',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4" /></svg>',
    color: 'violet',
  },
  {
    name: 'Mobile Device Management',
    description: 'Windows Autopilot, Apple DEP, and Android Enterprise',
    href: '/solutions/mdm',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>',
    color: 'green',
  },
  {
    name: 'Warehousing & Logistics',
    description: 'Device storage, global shipping, and returns processing',
    href: '/solutions/warehousing',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z" /></svg>',
    color: 'amber',
  },
  {
    name: 'Microsoft Licensing',
    description: 'Microsoft 365, Windows, and Azure license management',
    href: '/solutions/microsoft-licensing',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>',
    color: 'blue',
  },
  {
    name: 'Device Provenance',
    description: 'Blockchain-backed chain-of-custody and carbon tracking',
    href: '/solutions/device-provenance',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" /></svg>',
    color: 'emerald',
  },
];
---

<nav id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 py-6">
  <div class="max-w-7xl mx-auto px-6 flex items-center justify-between">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-3 group">
      <img
        src="/issyx-logo.svg"
        alt="Issyx"
        class="w-8 h-8 brightness-0 invert transition-transform duration-300 group-hover:scale-110"
      />
      <span class="text-xl font-bold font-brand tracking-wider">ISSYX</span>
    </a>

    <!-- Desktop Nav Links -->
    <div class="hidden lg:flex items-center gap-8">
      <!-- Solutions Dropdown -->
      <div class="relative group">
        <button class="flex items-center gap-1 text-gray-400 hover:text-white transition-colors">
          Solutions
          <svg class="w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </button>

        <!-- Dropdown Menu -->
        <div class="absolute top-full left-1/2 -translate-x-1/2 pt-4 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
          <div class="bg-dark-surface border border-dark-border rounded-2xl shadow-xl p-4 w-80">
            <div class="space-y-1">
              {solutions.map((solution) => (
                <a
                  href={solution.href}
                  class="flex items-start gap-3 p-3 rounded-xl hover:bg-dark-bg transition-colors group/item"
                >
                  <div class={`w-10 h-10 rounded-lg bg-${solution.color}-600/20 flex items-center justify-center text-${solution.color}-400 flex-shrink-0`}>
                    <Fragment set:html={solution.icon} />
                  </div>
                  <div>
                    <div class="font-medium text-white group-hover/item:text-primary-400 transition-colors">
                      {solution.name}
                    </div>
                    <div class="text-sm text-gray-500">
                      {solution.description}
                    </div>
                  </div>
                </a>
              ))}
            </div>
          </div>
        </div>
      </div>

      <a href="/#features" class="text-gray-400 hover:text-white transition-colors">
        Features
      </a>
      <a href="/pricing" class="text-gray-400 hover:text-white transition-colors">
        Pricing
      </a>
      <a href="/contact" class="text-gray-400 hover:text-white transition-colors">
        Contact
      </a>
    </div>

    <!-- CTAs -->
    <div class="hidden sm:flex items-center gap-4">
      <a
        href={`${portalUrl}/login`}
        class="text-gray-400 hover:text-white transition-colors"
      >
        Sign In
      </a>
      <a
        href="/contact"
        class="px-5 py-2.5 bg-primary-600 hover:bg-primary-500 rounded-lg font-medium transition-all duration-300 hover:shadow-lg hover:shadow-primary-600/25"
      >
        Get Started
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-btn"
      class="lg:hidden p-2 text-gray-400 hover:text-white"
      aria-label="Toggle menu"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
      </svg>
    </button>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden lg:hidden absolute top-full left-0 right-0 bg-dark-surface/95 backdrop-blur-md border-b border-dark-border">
    <div class="px-6 py-4 space-y-4">
      <!-- Solutions Section -->
      <div class="pb-4 border-b border-dark-border">
        <div class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-3">Solutions</div>
        {solutions.map((solution) => (
          <a href={solution.href} class="flex items-center gap-3 py-2 text-gray-400 hover:text-white transition-colors">
            <div class={`w-8 h-8 rounded-lg bg-${solution.color}-600/20 flex items-center justify-center text-${solution.color}-400`}>
              <Fragment set:html={solution.icon} />
            </div>
            <span>{solution.name}</span>
          </a>
        ))}
      </div>

      <a href="/#features" class="block text-gray-400 hover:text-white transition-colors">
        Features
      </a>
      <a href="/pricing" class="block text-gray-400 hover:text-white transition-colors">
        Pricing
      </a>
      <a href="/contact" class="block text-gray-400 hover:text-white transition-colors">
        Contact
      </a>
      <div class="pt-4 border-t border-dark-border space-y-3">
        <a href={`${portalUrl}/login`} class="block text-gray-400 hover:text-white transition-colors">
          Sign In
        </a>
        <a href="/contact" class="block w-full text-center px-5 py-2.5 bg-primary-600 hover:bg-primary-500 rounded-lg font-medium transition-colors">
          Get Started
        </a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Scroll effect for navbar
  const navbar = document.getElementById('navbar');

  function updateNavbar() {
    const currentScroll = window.scrollY;

    if (currentScroll > 50) {
      navbar?.classList.add('bg-dark-bg/90', 'backdrop-blur-md', 'border-b', 'border-dark-border', 'py-4');
      navbar?.classList.remove('py-6');
    } else {
      navbar?.classList.remove('bg-dark-bg/90', 'backdrop-blur-md', 'border-b', 'border-dark-border', 'py-4');
      navbar?.classList.add('py-6');
    }
  }

  window.addEventListener('scroll', updateNavbar, { passive: true });
  updateNavbar();

  // Mobile menu toggle
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');

  mobileMenuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
  });

  // Close mobile menu on link click
  mobileMenu?.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      mobileMenu?.classList.add('hidden');
    });
  });
</script>

<style>
  /* Ensure dropdown colors work */
  .bg-violet-600\/20 { background-color: rgb(124 58 237 / 0.2); }
  .text-violet-400 { color: rgb(167 139 250); }
  .bg-green-600\/20 { background-color: rgb(22 163 74 / 0.2); }
  .text-green-400 { color: rgb(74 222 128); }
  .bg-amber-600\/20 { background-color: rgb(217 119 6 / 0.2); }
  .text-amber-400 { color: rgb(251 191 36); }
  .bg-blue-600\/20 { background-color: rgb(37 99 235 / 0.2); }
  .text-blue-400 { color: rgb(96 165 250); }
  .bg-emerald-600\/20 { background-color: rgb(5 150 105 / 0.2); }
  .text-emerald-400 { color: rgb(52 211 153); }
</style>
