---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';

// Software modules with actual pricing (shown as monthly, billed annually)
const softwareModules = [
  {
    id: 'lifecycle',
    name: 'Device Lifecycle',
    description: 'Inventory tracking, workflows, asset tagging, reporting',
    singleTenant: 83,
    msp: 125,
    unit: '/month*',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17V7m0 10a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h2a2 2 0 012 2m0 10a2 2 0 002 2h2a2 2 0 002-2M9 7a2 2 0 012-2h2a2 2 0 012 2m0 10V7m0 10a2 2 0 002 2h2a2 2 0 002-2V7a2 2 0 00-2-2h-2a2 2 0 00-2 2" /></svg>',
  },
  {
    id: 'imaging',
    name: 'Imaging & Deployment',
    description: 'PXE infrastructure, custom profiles, unlimited devices',
    singleTenant: 250,
    msp: 417,
    unit: '/month*',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" /></svg>',
  },
  {
    id: 'mdm',
    name: 'MDM',
    description: 'Windows Autopilot, Apple DEP, Android Enterprise, policies',
    singleTenant: 3,
    msp: 3,
    unit: '/device/month*',
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>',
  },
  {
    id: 'licensing',
    name: 'Microsoft Licensing',
    description: 'License procurement, tracking, compliance reporting',
    singleTenant: null,
    msp: null,
    unit: '',
    contactUs: true,
    icon: '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" /></svg>',
  },
];

// Warehousing pricing
const warehousingTiers = [
  {
    name: 'Storage Tier 1',
    devices: '1-99 devices',
    price: 12,
    unit: '/device/month*',
  },
  {
    name: 'Storage Tier 2',
    devices: '100+ devices',
    price: 10,
    unit: '/device/month*',
    popular: true,
  },
];

const warehousingFeatures = [
  'Secure US-based storage',
  'Unlimited imaging included',
  'ISSYX packaging provided',
  'Portal access',
  'Returns processing',
];

// Add-on services
const addons = [
  {
    name: 'Per-Job Imaging',
    description: 'One-time imaging with portal access',
    price: '$45',
    unit: '/device',
  },
  {
    name: 'Laser Engraving',
    description: 'Asset tags, logos, property messages',
    price: 'from $5',
    unit: '/side',
  },
];

const faqs = [
  {
    question: 'How is pricing structured?',
    answer: 'Pricing is based on which modules you need. Software modules are flat annual fees (or per-device for MDM), while warehousing is billed per device stored. All pricing requires a signed annual contract.',
  },
  {
    question: 'Is there a minimum commitment?',
    answer: 'Yes, we require a 1-year minimum commitment with annual billing. All subscriptions require a signed contract before activation.',
  },
  {
    question: 'Can I add modules later?',
    answer: 'Yes! Start with just the modules you need and add more as your requirements grow. Contact your account manager to modify your subscription.',
  },
  {
    question: 'What support is included?',
    answer: 'All plans include email and chat support. Dedicated account management and phone support are available for enterprise customers.',
  },
  {
    question: 'What payment methods do you accept?',
    answer: 'We accept credit card, wire transfer, and purchase orders (Net 30 terms available for qualified customers).',
  },
  {
    question: 'Are there volume discounts?',
    answer: 'Yes, we offer volume discounts for larger device counts and bundle discounts when combining multiple modules. Contact sales for a custom quote.',
  },
];
---

<Layout title="Pricing - Issyx" description="Transparent pricing for device lifecycle management. Pay only for the modules you need. All plans billed annually.">
  <Navbar />
  <main>
    <!-- Hero -->
    <section class="pt-32 pb-16 px-6 relative overflow-hidden">
      <div class="absolute inset-0 bg-gradient-to-b from-primary-900/20 to-transparent"></div>
      <div class="max-w-4xl mx-auto relative text-center">
        <h1 class="text-4xl md:text-6xl font-bold mb-6">
          Simple, <span class="gradient-text">transparent pricing</span>
        </h1>
        <p class="text-xl text-gray-400 mb-4">
          Pay only for the modules you need. All plans billed annually.
        </p>
        <p class="text-sm text-gray-500">
          Volume and bundle discounts available. Contact sales for a custom quote.
        </p>
      </div>
    </section>

    <!-- Software Modules with Toggle -->
    <section class="py-16 px-6">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-10">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Software Modules</h2>
          <p class="text-gray-400 mb-8">Select your organization type to see pricing</p>

          <!-- Toggle Switch -->
          <div class="inline-flex items-center bg-dark-surface border border-dark-border rounded-full p-1">
            <button
              id="toggle-single"
              class="toggle-btn px-6 py-2 rounded-full text-sm font-medium transition-all bg-primary-500 text-white"
              data-tier="single"
            >
              Single Tenant
            </button>
            <button
              id="toggle-msp"
              class="toggle-btn px-6 py-2 rounded-full text-sm font-medium transition-all text-gray-400 hover:text-white"
              data-tier="msp"
            >
              MSP / Multi-Tenant
            </button>
          </div>
        </div>

        <!-- Module Cards -->
        <div class="space-y-4">
          {softwareModules.map((module) => (
            <div class="bg-dark-surface border border-dark-border rounded-xl p-6 hover:border-primary-500/30 transition-colors">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                  <div class="w-12 h-12 rounded-xl bg-primary-600/20 flex items-center justify-center text-primary-400">
                    <Fragment set:html={module.icon} />
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold text-white">{module.name}</h3>
                    <p class="text-sm text-gray-500">{module.description}</p>
                  </div>
                </div>
                <div class="text-right">
                  {module.contactUs ? (
                    <a href="/contact" class="text-primary-400 hover:text-primary-300 font-medium">
                      Contact Us
                    </a>
                  ) : (
                    <div>
                      <span class="text-2xl font-bold text-white price-display" data-single={module.singleTenant} data-msp={module.msp}>
                        ${module.singleTenant}
                      </span>
                      <span class="text-gray-400 text-sm">{module.unit}</span>
                    </div>
                  )}
                </div>
              </div>
            </div>
          ))}
        </div>

        <p class="text-center text-sm text-gray-500 mt-6">
          *Billed annually. 1-year minimum commitment. Contract required.
        </p>

        <div class="text-center mt-8">
          <a href="/contact" class="btn-primary inline-flex items-center gap-2">
            Get a Custom Quote
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>
      </div>
    </section>

    <!-- Warehousing Services -->
    <section class="py-16 px-6 bg-dark-surface/30">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Warehousing Services</h2>
          <p class="text-xl text-gray-400">Secure device storage with imaging and shipping included</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
          {warehousingTiers.map((tier) => (
            <div class={`bg-dark-surface border rounded-2xl p-8 ${tier.popular ? 'border-primary-500' : 'border-dark-border'} relative`}>
              {tier.popular && (
                <div class="absolute -top-3 left-6 px-3 py-1 bg-primary-500 text-white text-xs font-semibold rounded-full">
                  Best Value
                </div>
              )}
              <div class="mb-4">
                <h3 class="text-xl font-bold text-white">{tier.name}</h3>
                <p class="text-gray-400 text-sm">{tier.devices}</p>
              </div>
              <div class="mb-6">
                <span class="text-4xl font-bold text-white">${tier.price}</span>
                <span class="text-gray-400">{tier.unit}</span>
              </div>
              <ul class="space-y-3">
                {warehousingFeatures.map((feature) => (
                  <li class="flex items-center gap-2 text-gray-300 text-sm">
                    <svg class="w-4 h-4 text-primary-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    {feature}
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </div>

        <p class="text-center text-sm text-gray-500">
          *Billed annually. Volume discounts available for 150+ devices.
        </p>
      </div>
    </section>

    <!-- Add-ons -->
    <section class="py-16 px-6">
      <div class="max-w-5xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Add-on Services</h2>
          <p class="text-xl text-gray-400">Additional services available with any plan</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {addons.map((addon) => (
            <div class="bg-dark-surface border border-dark-border rounded-xl p-6 text-center">
              <h3 class="text-lg font-semibold text-white mb-2">{addon.name}</h3>
              <p class="text-gray-400 text-sm mb-4">{addon.description}</p>
              <div>
                <span class="text-2xl font-bold text-white">{addon.price}</span>
                <span class="text-gray-400 text-sm"> {addon.unit}</span>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- CTA -->
    <section class="py-16 px-6">
      <div class="max-w-4xl mx-auto">
        <div class="bg-gradient-to-br from-primary-600/20 to-purple-600/20 rounded-2xl p-8 md:p-12 text-center">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Ready to get started?</h2>
          <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
            Tell us about your device fleet and requirements. We'll put together a custom package and walk you through the contract process.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="/contact" class="btn-primary text-lg">Contact Sales</a>
            <a href="https://app.issyx.com/login" class="px-6 py-3 rounded-lg border border-dark-border text-white hover:bg-dark-surface transition-colors text-lg">
              Sign In
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section class="py-16 px-6">
      <div class="max-w-4xl mx-auto">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Pricing FAQ</h2>
        </div>

        <div class="space-y-4">
          {faqs.map((faq, index) => (
            <div class="faq-item border border-dark-border rounded-xl overflow-hidden">
              <button
                class="faq-trigger w-full px-6 py-5 flex items-center justify-between text-left hover:bg-dark-surface/50 transition-colors"
                aria-expanded="false"
                data-index={index}
              >
                <span class="font-semibold text-white pr-8">{faq.question}</span>
                <svg class="faq-icon w-5 h-5 text-gray-500 flex-shrink-0 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <div class="faq-content hidden px-6 pb-5">
                <p class="text-gray-400 leading-relaxed">{faq.answer}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout>

<script>
  // Toggle functionality
  const toggleSingle = document.getElementById('toggle-single');
  const toggleMsp = document.getElementById('toggle-msp');
  const priceDisplays = document.querySelectorAll('.price-display');

  function updatePrices(tier: 'single' | 'msp') {
    priceDisplays.forEach(el => {
      const price = tier === 'single' ? el.getAttribute('data-single') : el.getAttribute('data-msp');
      el.textContent = `$${price}`;
    });

    // Update toggle styles
    if (tier === 'single') {
      toggleSingle?.classList.add('bg-primary-500', 'text-white');
      toggleSingle?.classList.remove('text-gray-400');
      toggleMsp?.classList.remove('bg-primary-500', 'text-white');
      toggleMsp?.classList.add('text-gray-400');
    } else {
      toggleMsp?.classList.add('bg-primary-500', 'text-white');
      toggleMsp?.classList.remove('text-gray-400');
      toggleSingle?.classList.remove('bg-primary-500', 'text-white');
      toggleSingle?.classList.add('text-gray-400');
    }
  }

  toggleSingle?.addEventListener('click', () => updatePrices('single'));
  toggleMsp?.addEventListener('click', () => updatePrices('msp'));

  // FAQ functionality
  document.querySelectorAll('.faq-trigger').forEach(trigger => {
    trigger.addEventListener('click', () => {
      const item = trigger.closest('.faq-item');
      const content = item?.querySelector('.faq-content');
      const icon = trigger.querySelector('.faq-icon');
      const isExpanded = trigger.getAttribute('aria-expanded') === 'true';

      // Close all other items
      document.querySelectorAll('.faq-item').forEach(otherItem => {
        if (otherItem !== item) {
          otherItem.querySelector('.faq-content')?.classList.add('hidden');
          otherItem.querySelector('.faq-trigger')?.setAttribute('aria-expanded', 'false');
          otherItem.querySelector('.faq-icon')?.classList.remove('rotate-180');
        }
      });

      // Toggle current item
      content?.classList.toggle('hidden');
      trigger.setAttribute('aria-expanded', String(!isExpanded));
      icon?.classList.toggle('rotate-180');
    });
  });
</script>

<style>
  .faq-icon {
    transition: transform 0.2s ease-out;
  }

  .toggle-btn {
    transition: all 0.2s ease-out;
  }
</style>
